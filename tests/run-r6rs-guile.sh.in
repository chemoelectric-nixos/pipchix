#!@SHELL@
#
# Run a tiny Râ¶RS program in Guile.
#

prog_scm=`TMPDIR=. mktemp 2>/dev/null || echo tmp."${RANDOM}"`.scm

cat > "${prog_scm}" <<EOF
(import (rnrs (6))
        (pipchix abstract-syntax-tree)
        (pipchix nix-embed)
        (pipchix nix-list)
        (pipchix nix-set))
(output-nix-abstract-syntax-tree $1)
(exit 0)
EOF

env LC_ALL="@TEST_LOCALE@" \
    LANG="@TEST_LOCALE@" \
    @GUILE@ --language=scheme --r6rs \
    -q -L '@abs_top_builddir@/r6rs' \
    --no-auto-compile -s "${prog_scm}"

rm "${prog_scm}"

exit 0

# local variables:
# mode: shell-script
# sh-shell: sh
# end:
