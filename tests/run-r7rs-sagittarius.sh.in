#!@SHELL@
#
# Run a tiny Râ·RS program in Sagittarius Scheme.
#

prog_scm=`@abs_top_builddir@/tempname`.scm

cat > "${prog_scm}" <<EOF
(import (scheme base))
(import (scheme process-context))
(import (scheme write))
(import (pipchix general-purpose cut))
(import (pipchix general-purpose list))
(import (pipchix general-purpose match))
(import (pipchix general-purpose division))
(import (pipchix general-purpose e-macros))
(import (pipchix general-purpose eager-macros))
(import (pipchix general-purpose combinators))
(import (pipchix general-purpose continuation-capture))
(import (pipchix abstract-syntax-tree))
(import (pipchix nix-embed))
(import (pipchix nix-list))
(import (pipchix string-manipulation))
(import (pipchix essentials))
(output-nix-abstract-syntax-tree $1)
(exit 0)
EOF

env LC_ALL="@TEST_LOCALE@" \
    LANG="@TEST_LOCALE@" \
    @SAGITTARIUS@ -d -r7 --loadpath='@abs_top_builddir@/r7rs' "${prog_scm}"

rm "${prog_scm}"

exit 0

# local variables:
# mode: shell-script
# sh-shell: sh
# end:
